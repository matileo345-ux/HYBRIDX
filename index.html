import React, { useState, useEffect } from 'react';
import { ThirdwebProvider, ConnectWallet, useAddress, useSendTransaction, useChainId, useSwitchChain } from '@thirdweb-dev/react';
import { BinanceSmartChainMainnet } from '@thirdweb-dev/chains';

function WhitelistApp() {
  const address = useAddress();
  const chainId = useChainId();
  const switchChain = useSwitchChain();
  const { mutate: sendTransaction, isLoading, isSuccess, isError } = useSendTransaction();
  const [isWhitelisted, setIsWhitelisted] = useState(false);
  const [menuOpen, setMenuOpen] = useState(false);
  const [activeSection, setActiveSection] = useState('home');
  const [faqOpen, setFaqOpen] = useState(null);
  const [spotsRemaining] = useState(14237);

  const DEPOSIT_ADDRESS = '0x742d35Cc6634C0532925a3b844Bc454e4438f44e';
  const DEPOSIT_AMOUNT = '0.005';

  useEffect(() => {
    if (address) {
      const whitelisted = localStorage.getItem(`whitelisted_${address}`);
      setIsWhitelisted(whitelisted === 'true');
    }
  }, [address]);

  useEffect(() => {
    if (isSuccess) {
      setIsWhitelisted(true);
      localStorage.setItem(`whitelisted_${address}`, 'true');
    }
  }, [isSuccess, address]);

  const handleJoinWhitelist = async () => {
    if (chainId !== 56) {
      try {
        await switchChain(56);
      } catch (error) {
        alert('Please switch to Binance Smart Chain');
        return;
      }
    }

    const tx = {
      to: DEPOSIT_ADDRESS,
      value: DEPOSIT_AMOUNT,
    };

    sendTransaction(tx);
  };

  const faqs = [
    { q: "What is HYBRIDX?", a: "HYBRIDX is the world's first hybrid DeFi launchpool on Binance Smart Chain, combining launchpad and launchpool mechanics for fair token distribution." },
    { q: "How much do I need to deposit?", a: "Just 0.005 BNB (â‰ˆ$2-$3) to secure your whitelist spot and eligibility for the $1M BNB + $1M HYBRIDX airdrop." },
    { q: "When is the main app launch?", a: "Q1 2026. The main app will include the launchpool where you can stake BNB to earn HYBRIDX tokens." },
    { q: "How is the $1M airdrop distributed?", a: "Pro-rata distribution among all 20,000 whitelisted participants. Early participants get priority allocation." },
    { q: "Is this safe?", a: "100% on-chain and transparent. Your deposit goes directly to our verified BSC address. Smart contracts will be audited before launch." },
  ];

  return (
    <div style={styles.app}>
      {/* Header */}
      <header style={styles.header}>
        <div style={styles.headerContent}>
          <div style={styles.logo}>
            <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
              <path d="M8 16C8 16 12 8 20 8C28 8 32 16 32 16" stroke="url(#gradient1)" strokeWidth="3" strokeLinecap="round"/>
              <path d="M32 24C32 24 28 32 20 32C12 32 8 24 8 24" stroke="url(#gradient2)" strokeWidth="3" strokeLinecap="round"/>
              <defs>
                <linearGradient id="gradient1" x1="8" y1="8" x2="32" y2="16">
                  <stop stopColor="#FF6B35"/>
                  <stop offset="1" stopColor="#F7931E"/>
                </linearGradient>
                <linearGradient id="gradient2" x1="8" y1="24" x2="32" y2="32">
                  <stop stopColor="#F7931E"/>
                  <stop offset="1" stopColor="#FCBA04"/>
                </linearGradient>
              </defs>
            </svg>
          </div>
          <ConnectWallet 
            theme="dark"
            btnTitle="Connect"
            style={{
              background: 'transparent',
              border: '1px solid rgba(255, 107, 53, 0.5)',
              borderRadius: '8px',
              color: '#FF6B35',
              fontSize: '14px',
              fontWeight: '500',
              padding: '10px 24px',
              fontFamily: 'Inter, sans-serif',
            }}
          />
        </div>
      </header>

      {/* Mobile Menu */}
      <button style={styles.menuToggle} onClick={() => setMenuOpen(!menuOpen)}>
        <div style={styles.hamburger}>
          <span style={{...styles.bar, transform: menuOpen ? 'rotate(45deg) translateY(8px)' : 'none'}}></span>
          <span style={{...styles.bar, opacity: menuOpen ? 0 : 1}}></span>
          <span style={{...styles.bar, transform: menuOpen ? 'rotate(-45deg) translateY(-8px)' : 'none'}}></span>
        </div>
      </button>

      {menuOpen && (
        <div style={styles.mobileMenu}>
          <button style={styles.menuItem} onClick={() => { setActiveSection('home'); setMenuOpen(false); }}>Home</button>
          <button style={styles.menuItem} onClick={() => { setActiveSection('about'); setMenuOpen(false); }}>About</button>
          <button style={styles.menuItem} onClick={() => { setActiveSection('benefits'); setMenuOpen(false); }}>Benefits</button>
          <button style={styles.menuItem} onClick={() => { setActiveSection('faq'); setMenuOpen(false); }}>FAQ</button>
        </div>
      )}

      {/* Main Content */}
      <main style={styles.main}>
        {activeSection === 'home' && (
          <>
            {/* Hero Section */}
            <section style={styles.hero}>
              <div style={styles.heroContent}>
                <h1 style={styles.title}>HYBRIDX</h1>
                
                {/* Card Display */}
                <div style={styles.cardContainer}>
                  <div style={styles.card}>
                    <div style={styles.cardInner}>
                      <div style={styles.cardPattern}></div>
                      <svg width="120" height="120" viewBox="0 0 120 120" style={styles.cardLogo}>
                        <path d="M24 48C24 48 36 24 60 24C84 24 96 48 96 48" stroke="#FF6B35" strokeWidth="6" strokeLinecap="round"/>
                        <path d="M96 72C96 72 84 96 60 96C36 96 24 72 24 72" stroke="#FCBA04" strokeWidth="6" strokeLinecap="round"/>
                      </svg>
                    </div>
                  </div>
                  <div style={{...styles.card, marginLeft: '-40px'}}>
                    <div style={{...styles.cardInner, background: 'linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)'}}>
                      <div style={styles.cardPattern}></div>
                      <svg width="120" height="120" viewBox="0 0 120 120" style={styles.cardLogo}>
                        <path d="M24 48C24 48 36 24 60 24C84 24 96 48 96 48" stroke="#ffffff" strokeWidth="6" strokeLinecap="round"/>
                        <path d="M96 72C96 72 84 96 60 96C36 96 24 72 24 72" stroke="#cccccc" strokeWidth="6" strokeLinecap="round"/>
                      </svg>
                    </div>
                  </div>
                </div>

                <h2 style={styles.subtitle}>
                  #beyourownVC and join the<br/>
                  <span style={styles.highlight}>HYBRIDX Whitelist</span>
                </h2>

                {!address ? (
                  <p style={styles.connectPrompt}>Connect your wallet to join</p>
                ) : isWhitelisted ? (
                  <div style={styles.statusBox}>
                    <div style={styles.successIcon}>âœ“</div>
                    <p style={styles.statusText}>You're whitelisted!</p>
                    <p style={styles.statusSubtext}>Eligible for $1M BNB + $1M HYBRIDX airdrop</p>
                  </div>
                ) : (
                  <>
                    <button 
                      style={styles.mainButton}
                      onClick={handleJoinWhitelist}
                      disabled={isLoading}
                    >
                      {isLoading ? 'Processing...' : 'Join Whitelist (0.005 BNB)'}
                    </button>
                    <p style={styles.spotsText}>{(20000 - spotsRemaining).toLocaleString()} / 20,000 spots claimed</p>
                  </>
                )}

                {isError && (
                  <div style={styles.errorBox}>
                    Transaction failed. Please try again.
                  </div>
                )}
              </div>
            </section>

            {/* Quick Info */}
            <section style={styles.infoSection}>
              <div style={styles.infoGrid}>
                <div style={styles.infoCard}>
                  <div style={styles.infoNumber}>$2M</div>
                  <div style={styles.infoLabel}>Total Airdrop Pool</div>
                </div>
                <div style={styles.infoCard}>
                  <div style={styles.infoNumber}>20,000</div>
                  <div style={styles.infoLabel}>Whitelist Spots</div>
                </div>
                <div style={styles.infoCard}>
                  <div style={styles.infoNumber}>Q1 2026</div>
                  <div style={styles.infoLabel}>Launch Date</div>
                </div>
              </div>
            </section>
          </>
        )}

        {activeSection === 'about' && (
          <section style={styles.section}>
            <h2 style={styles.sectionTitle}>About HYBRIDX</h2>
            <div style={styles.aboutContent}>
              <p style={styles.aboutText}>
                HYBRIDX is the world's first hybrid DeFi launchpool on Binance Smart Chain (BSC), 
                revolutionizing how communities participate in token launches.
              </p>
              <div style={styles.featureList}>
                <div style={styles.feature}>
                  <span style={styles.featureIcon}>âš¡</span>
                  <span style={styles.featureText}>Hybrid launchpad + launchpool mechanics</span>
                </div>
                <div style={styles.feature}>
                  <span style={styles.featureIcon}>ðŸ’Ž</span>
                  <span style={styles.featureText}>Fair distribution - no VC dumping</span>
                </div>
                <div style={styles.feature}>
                  <span style={styles.featureIcon}>ðŸš€</span>
                  <span style={styles.featureText}>Stake BNB to earn HYBRIDX tokens</span>
                </div>
                <div style={styles.feature}>
                  <span style={styles.featureIcon}>ðŸŽ¯</span>
                  <span style={styles.featureText}>Community-first approach</span>
                </div>
              </div>
            </div>
          </section>
        )}

        {activeSection === 'benefits' && (
          <section style={styles.section}>
            <h2 style={styles.sectionTitle}>Whitelist Benefits</h2>
            <div style={styles.benefitsList}>
              <div style={styles.benefitItem}>
                <h3 style={styles.benefitTitle}>Priority Access</h3>
                <p style={styles.benefitDesc}>Be among the first to stake in the Q1 2026 launchpool with enhanced multipliers</p>
              </div>
              <div style={styles.benefitItem}>
                <h3 style={styles.benefitTitle}>Massive Airdrop</h3>
                <p style={styles.benefitDesc}>Share of $1M BNB + $1M HYBRIDX distributed pro-rata to all whitelisted wallets</p>
              </div>
              <div style={styles.benefitItem}>
                <h3 style={styles.benefitTitle}>Fair Launch</h3>
                <p style={styles.benefitDesc}>No VC dumping, no presale. Pure community-driven with equal opportunity for all</p>
              </div>
            </div>
          </section>
        )}

        {activeSection === 'faq' && (
          <section style={styles.section}>
            <h2 style={styles.sectionTitle}>FAQ</h2>
            <div style={styles.faqList}>
              {faqs.map((faq, i) => (
                <div key={i} style={styles.faqItem}>
                  <button 
                    style={styles.faqQuestion}
                    onClick={() => setFaqOpen(faqOpen === i ? null : i)}
                  >
                    <span>{faq.q}</span>
                    <span style={{...styles.faqIcon, transform: faqOpen === i ? 'rotate(180deg)' : 'none'}}>â–¼</span>
                  </button>
                  {faqOpen === i && (
                    <div style={styles.faqAnswer}>
                      <p>{faq.a}</p>
                    </div>
                  )}
                </div>
              ))}
            </div>
          </section>
        )}
      </main>

      {/* Footer */}
      <footer style={styles.footer}>
        <div style={styles.footerContent}>
          <p style={styles.footerText}>Â© 2026 HYBRIDX. All rights reserved.</p>
          <div style={styles.socialLinks}>
            <a href="https://x.com/HYBRIDX_HYBX" target="_blank" style={styles.socialLink}>Twitter</a>
            <a href="#" style={styles.socialLink}>Telegram</a>
            <a href="#" style={styles.socialLink}>Discord</a>
          </div>
        </div>
      </footer>
    </div>
  );
}

const styles = {
  app: {
    minHeight: '100vh',
    background: '#0a0a0a',
    color: '#ffffff',
    fontFamily: 'Inter, sans-serif',
  },
  header: {
    position: 'fixed',
    top: 0,
    left: 0,
    right: 0,
    zIndex: 1000,
    background: 'rgba(10, 10, 10, 0.95)',
    backdropFilter: 'blur(10px)',
    borderBottom: '1px solid rgba(255, 255, 255, 0.05)',
  },
  headerContent: {
    maxWidth: '1200px',
    margin: '0 auto',
    padding: '20px 24px',
    display: 'flex',
    justifyContent: 'space-between',
    alignItems: 'center',
  },
  logo: {
    display: 'flex',
    alignItems: 'center',
  },
  menuToggle: {
    position: 'fixed',
    bottom: '24px',
    right: '24px',
    zIndex: 1001,
    width: '56px',
    height: '56px',
    background: '#1a1a1a',
    border: '1px solid rgba(255, 107, 53, 0.3)',
    borderRadius: '12px',
    cursor: 'pointer',
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    transition: 'all 0.3s ease',
  },
  hamburger: {
    width: '24px',
    height: '18px',
    position: 'relative',
    display: 'flex',
    flexDirection: 'column',
    justifyContent: 'space-between',
  },
  bar: {
    width: '100%',
    height: '2px',
    background: '#FF6B35',
    transition: 'all 0.3s ease',
  },
  mobileMenu: {
    position: 'fixed',
    bottom: '90px',
    right: '24px',
    zIndex: 1000,
    background: '#1a1a1a',
    border: '1px solid rgba(255, 107, 53, 0.3)',
    borderRadius: '12px',
    padding: '12px',
    minWidth: '180px',
  },
  menuItem: {
    width: '100%',
    padding: '12px 16px',
    background: 'transparent',
    border: 'none',
    color: '#ffffff',
    textAlign: 'left',
    cursor: 'pointer',
    fontSize: '14px',
    transition: 'all 0.2s ease',
    borderRadius: '6px',
  },
  main: {
    paddingTop: '80px',
    minHeight: 'calc(100vh - 80px)',
  },
  hero: {
    maxWidth: '800px',
    margin: '0 auto',
    padding: '80px 24px 60px',
    textAlign: 'center',
  },
  heroContent: {
    display: 'flex',
    flexDirection: 'column',
    alignItems: 'center',
  },
  title: {
    fontSize: '32px',
    fontWeight: '700',
    marginBottom: '48px',
    letterSpacing: '2px',
  },
  cardContainer: {
    display: 'flex',
    justifyContent: 'center',
    marginBottom: '48px',
    perspective: '1000px',
  },
  card: {
    width: '240px',
    height: '340px',
    transition: 'transform 0.3s ease',
  },
  cardInner: {
    width: '100%',
    height: '100%',
    background: 'linear-gradient(135deg, #2d1810 0%, #1a0f0a 100%)',
    border: '2px solid rgba(255, 107, 53, 0.3)',
    borderRadius: '16px',
    padding: '32px',
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    position: 'relative',
    overflow: 'hidden',
  },
  cardPattern: {
    position: 'absolute',
    inset: 0,
    background: 'repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255, 107, 53, 0.03) 10px, rgba(255, 107, 53, 0.03) 20px)',
  },
  cardLogo: {
    position: 'relative',
    zIndex: 1,
  },
  subtitle: {
    fontSize: '28px',
    fontWeight: '400',
    lineHeight: '1.5',
    marginBottom: '40px',
    color: 'rgba(255, 255, 255, 0.9)',
  },
  highlight: {
    color: '#FF6B35',
    fontWeight: '600',
  },
  connectPrompt: {
    fontSize: '16px',
    color: 'rgba(255, 255, 255, 0.6)',
    marginTop: '24px',
  },
  mainButton: {
    padding: '16px 48px',
    background: 'transparent',
    border: '2px solid #FF6B35',
    borderRadius: '8px',
    color: '#FF6B35',
    fontSize: '16px',
    fontWeight: '600',
    cursor: 'pointer',
    transition: 'all 0.3s ease',
    fontFamily: 'Inter, sans-serif',
  },
  spotsText: {
    marginTop: '16px',
    fontSize: '14px',
    color: 'rgba(255, 255, 255, 0.5)',
  },
  statusBox: {
    padding: '32px',
    background: 'rgba(16, 185, 129, 0.1)',
    border: '1px solid rgba(16, 185, 129, 0.3)',
    borderRadius: '12px',
    textAlign: 'center',
  },
  successIcon: {
    width: '48px',
    height: '48px',
    margin: '0 auto 16px',
    background: 'rgba(16, 185, 129, 0.2)',
    borderRadius: '50%',
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    fontSize: '24px',
    color: '#10b981',
  },
  statusText: {
    fontSize: '20px',
    fontWeight: '600',
    color: '#10b981',
    marginBottom: '8px',
  },
  statusSubtext: {
    fontSize: '14px',
    color: 'rgba(255, 255, 255, 0.6)',
  },
  errorBox: {
    marginTop: '16px',
    padding: '12px 24px',
    background: 'rgba(239, 68, 68, 0.1)',
    border: '1px solid rgba(239, 68, 68, 0.3)',
    borderRadius: '8px',
    color: '#ef4444',
    fontSize: '14px',
  },
  infoSection: {
    padding: '60px 24px',
    background: 'rgba(255, 255, 255, 0.02)',
  },
  infoGrid: {
    maxWidth: '900px',
    margin: '0 auto',
    display: 'grid',
    gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
    gap: '24px',
  },
  infoCard: {
    padding: '32px',
    background: 'rgba(255, 255, 255, 0.03)',
    border: '1px solid rgba(255, 255, 255, 0.05)',
    borderRadius: '12px',
    textAlign: 'center',
  },
  infoNumber: {
    fontSize: '32px',
    fontWeight: '700',
    color: '#FF6B35',
    marginBottom: '8px',
  },
  infoLabel: {
    fontSize: '14px',
    color: 'rgba(255, 255, 255, 0.6)',
  },
  section: {
    maxWidth: '800px',
    margin: '0 auto',
    padding: '80px 24px',
  },
  sectionTitle: {
    fontSize: '32px',
    fontWeight: '700',
    marginBottom: '48px',
    textAlign: 'center',
  },
  aboutContent: {
    padding: '40px',
    background: 'rgba(255, 255, 255, 0.02)',
    border: '1px solid rgba(255, 255, 255, 0.05)',
    borderRadius: '16px',
  },
  aboutText: {
    fontSize: '18px',
    lineHeight: '1.8',
    color: 'rgba(255, 255, 255, 0.8)',
    marginBottom: '32px',
  },
  featureList: {
    display: 'flex',
    flexDirection: 'column',
    gap: '16px',
  },
  feature: {
    display: 'flex',
    alignItems: 'center',
    gap: '16px',
  },
  featureIcon: {
    fontSize: '24px',
  },
  featureText: {
    fontSize: '16px',
    color: 'rgba(255, 255, 255, 0.8)',
  },
  benefitsList: {
    display: 'flex',
    flexDirection: 'column',
    gap: '24px',
  },
  benefitItem: {
    padding: '32px',
    background: 'rgba(255, 255, 255, 0.02)',
    border: '1px solid rgba(255, 255, 255, 0.05)',
    borderRadius: '12px',
  },
  benefitTitle: {
    fontSize: '20px',
    fontWeight: '600',
    color: '#FF6B35',
    marginBottom: '12px',
  },
  benefitDesc: {
    fontSize: '16px',
    lineHeight: '1.7',
    color: 'rgba(255, 255, 255, 0.7)',
  },
  faqList: {
    display: 'flex',
    flexDirection: 'column',
    gap: '12px',
  },
  faqItem: {
    background: 'rgba(255, 255, 255, 0.02)',
    border: '1px solid rgba(255, 255, 255, 0.05)',
    borderRadius: '12px',
    overflow: 'hidden',
  },
  faqQuestion: {
    width: '100%',
    padding: '20px 24px',
    background: 'transparent',
    border: 'none',
    color: '#ffffff',
    fontSize: '16px',
    fontWeight: '500',
    textAlign: 'left',
    cursor: 'pointer',
    display: 'flex',
    justifyContent: 'space-between',
    alignItems: 'center',
    fontFamily: 'Inter, sans-serif',
  },
  faqIcon: {
    fontSize: '12px',
    color: '#FF6B35',
    transition: 'transform 0.3s ease',
  },
  faqAnswer: {
    padding: '0 24px 20px',
    fontSize: '15px',
    lineHeight: '1.7',
    color: 'rgba(255, 255, 255, 0.7)',
  },
  footer: {
    borderTop: '1px solid rgba(255, 255, 255, 0.05)',
    padding: '32px 24px',
  },
  footerContent: {
    maxWidth: '1200px',
    margin: '0 auto',
    display: 'flex',
    justifyContent: 'space-between',
    alignItems: 'center',
    flexWrap: 'wrap',
    gap: '16px',
  },
  footerText: {
    fontSize: '14px',
    color: 'rgba(255, 255, 255, 0.4)',
  },
  socialLinks: {
    display: 'flex',
    gap: '24px',
  },
  socialLink: {
    fontSize: '14px',
    color: '#FF6B35',
    textDecoration: 'none',
    transition: 'opacity 0.2s ease',
  },
};

export default function App() {
  return (
    <ThirdwebProvider
      activeChain={BinanceSmartChainMainnet}
      clientId="YOUR_THIRDWEB_CLIENT_ID"
      supportedChains={[BinanceSmartChainMainnet]}
    >
      <style>
        {`
          @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
          
          * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
          }
          
          body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
          }

          button:hover {
            opacity: 0.8;
          }

          .menuItem:hover {
            background: rgba(255, 107, 53, 0.1) !important;
            color: #FF6B35 !important;
          }

          @media (max-width: 768px) {
            .card {
              width: 160px !important;
              height: 240px !important;
            }
            .cardInner {
              padding: 20px !important;
            }
            .cardLogo {
              width: 80px !important;
              height: 80px !important;
            }
          }
        `}
      </style>
      <WhitelistApp />
    </ThirdwebProvider>
  );
}
